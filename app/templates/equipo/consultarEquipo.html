{% extends '_base.html' %}

{% block title %}Consultar Equipo: {{ equipo.nombre_equipo }}{% endblock %}

{% block content %}
<div class="main-container">

    <div class="top-row">
        <div class="titulo">{{ equipo.nombre_equipo }}</div>

        <form method="POST" action="{{ url_for('eliminar_equipo', equipo_id=equipo.id) }}"
              onsubmit="return confirm('¿Estás seguro de que quieres eliminar el equipo {{ equipo.nombre_equipo }}?');">
            <button type="submit" class="btn-primary btn-delete">ELIMINAR EQUIPO</button>
        </form>
    </div>

    <div class="interface-grid">

        <div class="panel izquierda">
            {% for pokemon in pokemons %}
                {% if pokemon %}
                <button class="btn-secondary pokemon-btn"
                        data-nombre="{{ pokemon.nombre }}"
                        data-foto="{{ pokemon.foto_url }}"
                        data-stats="{{ pokemon.estadisticas }}"
                        data-desc="{{ pokemon.descripcion }}">
                    {{ pokemon.nombre }}
                </button>
                {% else %}
                <button class="btn-secondary pokemon-btn disabled" disabled>
                    Slot Vacío
                </button>
                {% endif %}
            {% endfor %}
        </div>

        <div class="panel panel-blue panel-right">

            <div class="Nombre Pokemon" id="pokemon-nombre">{{ pokemon_inicial.nombre }}</div>

            <div class="content-row">
                <div class="image-pokemon" id="pokemon-foto">
                    {% if pokemon_inicial.foto_url %}
                    <img src="{{ pokemon_inicial.foto_url }}" alt="{{ pokemon_inicial.nombre }}" style="width:100%; height:100%; object-fit:contain;">
                    {% else %}
                    No hay imagen
                    {% endif %}
                </div>

                <div class="text-estadistica" id="pokemon-stats">{{ pokemon_inicial.estadisticas }}</div>
            </div>

            <div class="text-descripcion" id="pokemon-descripcion">{{ pokemon_inicial.descripcion }}</div>
        </div>

    </div>

    <a href="{{ url_for('editar_equipo', equipo_id=equipo.id) }}" class="btn-primary btn-edit-bottom">EDITAR EQUIPO</a>

</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const btns = document.querySelectorAll('.pokemon-btn:not(.disabled)');
        const nombreEl = document.getElementById('pokemon-nombre');
        const fotoEl = document.getElementById('pokemon-foto');
        const statsEl = document.getElementById('pokemon-stats');
        const descEl = document.getElementById('pokemon-descripcion');

        btns.forEach(btn => {
            btn.addEventListener('click', function() {
                // Obtener datos del botón (data-atributos)
                const nombre = this.getAttribute('data-nombre');
                const fotoUrl = this.getAttribute('data-foto');
                const stats = this.getAttribute('data-stats');
                const desc = this.getAttribute('data-desc');

                // Actualizar el panel derecho
                nombreEl.textContent = nombre;
                statsEl.textContent = stats;
                descEl.textContent = desc;

                // Actualizar la imagen
                if (fotoUrl) {
                    fotoEl.innerHTML = `<img src="${fotoUrl}" alt="${nombre}" style="width:100%; height:100%; object-fit:contain;">`;
                } else {
                    fotoEl.textContent = "No hay imagen";
                }
            });
        });
    });
</script>
{% endblock %}